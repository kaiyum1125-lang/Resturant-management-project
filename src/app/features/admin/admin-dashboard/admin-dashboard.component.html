<div>
    <app-sidebar></app-sidebar>
</div>
<div class="page-container">
    <div class="admin-dashboard">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="header-content">
                <h1 class="page-title">
                    <i class="bi bi-speedometer2"></i>
                    Dashboard Overview
                </h1>
                <p class="page-subtitle">Welcome to your restaurant management dashboard</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-outline" (click)="refreshDashboard()" [disabled]="isLoading">
                    <i class="bi bi-arrow-clockwise" [class.spinning]="isLoading"></i>
                    Refresh
                </button>
                <button class="btn btn-primary" (click)="exportMenuData()">
                    <i class="bi bi-download"></i>
                    Export Data
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading" class="loading-state">
            <div class="spinner"></div>
            <p>Loading dashboard data...</p>
        </div>

        <!-- Stats Grid -->
        <div *ngIf="!isLoading" class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon primary">
                    <i class="bi bi-menu-button"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">{{stats.totalItems}}</h3>
                    <p class="stat-label">Total Menu Items</p>
                    <div class="stat-trend">
                        <span class="trend-item">{{stats.availableItems}} available</span>
                        <span class="trend-item">{{stats.unavailableItems}} unavailable</span>
                    </div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon success">
                    <i class="bi bi-check-circle"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">{{stats.availableItems}}</h3>
                    <p class="stat-label">Available Items</p>
                    <div class="stat-progress">
                        <div class="progress-bar">
                            <div class="progress-fill success"
                                [style.width]="(stats.availableItems / stats.totalItems * 100) + '%'">
                            </div>
                        </div>
                        <span class="progress-text">
                            {{(stats.availableItems / stats.totalItems * 100) | number:'1.0-0'}}%
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon info">
                    <i class="bi bi-tags"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">{{stats.totalCategories}}</h3>
                    <p class="stat-label">Categories</p>
                    <div class="stat-trend">
                        <span class="trend-item">{{stats.categoriesWithItems}} with items</span>
                    </div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon warning">
                    <i class="bi bi-currency-dollar"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">${{stats.averagePrice}}</h3>
                    <p class="stat-label">Average Price</p>
                    <div class="stat-trend">
                        <span *ngIf="stats.mostExpensiveItem" class="trend-item">
                            High: ${{stats.mostExpensiveItem.price}}
                        </span>
                        <span *ngIf="stats.leastExpensiveItem" class="trend-item">
                            Low: ${{stats.leastExpensiveItem.price}}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div *ngIf="!isLoading" class="charts-section">
            <div class="chart-row">
                <!-- Category Distribution -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Items by Category</h3>
                        <button class="btn-icon" (click)="refreshDashboard()">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                    <div class="chart-body">
                        <div *ngIf="categoryData.length > 0; else noCategoryData" class="category-chart">
                            <div *ngFor="let item of categoryData" class="category-item">
                                <div class="category-info">
                                    <span class="category-name">{{item.name}}</span>
                                    <span class="category-count">{{item.count}} items</span>
                                </div>
                                <div class="category-bar">
                                    <div class="bar-fill" [style.width]="(item.count / stats.totalItems * 100) + '%'"
                                        [style.background]="item.color">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ng-template #noCategoryData>
                            <div class="empty-chart">
                                <i class="bi bi-pie-chart"></i>
                                <p>No category data available</p>
                            </div>
                        </ng-template>
                    </div>
                </div>

                <!-- Price Distribution -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Price Range Distribution</h3>
                    </div>
                    <div class="chart-body">
                        <div *ngIf="priceRangeData.length > 0; else noPriceData" class="price-chart">
                            <div *ngFor="let range of priceRangeData" class="price-range">
                                <div class="range-info">
                                    <span class="range-label">{{range.label}}</span>
                                    <span class="range-count">{{range.count}} items</span>
                                </div>
                                <div class="range-bar">
                                    <div class="bar-fill" [style.width]="(range.count / stats.totalItems * 100) + '%'">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ng-template #noPriceData>
                            <div class="empty-chart">
                                <i class="bi bi-bar-chart"></i>
                                <p>No price data available</p>
                            </div>
                        </ng-template>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div *ngIf="!isLoading" class="actions-section">
            <h3>Quick Actions</h3>
            <div class="actions-grid">
                <button class="action-card primary" (click)="navigateToMenu()">
                    <i class="bi bi-plus-circle"></i>
                    <span>Add Menu Item</span>
                </button>
                <button class="action-card success" (click)="navigateToCategories()">
                    <i class="bi bi-tag"></i>
                    <span>Manage Categories</span>
                </button>
                <button class="action-card info" (click)="navigateToOrders()">
                    <i class="bi bi-receipt"></i>
                    <span>View Orders</span>
                </button>
                <button class="action-card warning" (click)="exportMenuData()">
                    <i class="bi bi-download"></i>
                    <span>Export Data</span>
                </button>
            </div>
        </div>

        <!-- Recent Activity -->
        <div *ngIf="!isLoading" class="activity-section">
            <div class="section-header">
                <h3>Recent Activity</h3>
                <button class="btn-text">View All</button>
            </div>
            <div class="activity-list">
                <div *ngFor="let activity of recentActivities" class="activity-item">
                    <div class="activity-icon" [ngClass]="getActivityTypeClass(activity.type)">
                        <i [class]="getActivityIcon(activity.type)"></i>
                    </div>
                    <div class="activity-content">
                        <p class="activity-title">{{activity.title}}</p>
                        <p class="activity-meta">{{activity.category}} â€¢ {{activity.time}}</p>
                    </div>
                    <div class="activity-badge" [ngClass]="activity.type">
                        {{activity.type}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>